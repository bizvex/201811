clc;
clear;
markers  = {'.' 'd' 's' 'o','+','^','p','*','p','h'};
marker_color = {'r','g',[0.1 0.6 0.9],'c','b',[0.2 0.9 0.5],[0.5 0.2 0.9],[0.9 0.5 0.2],[0.6 0.1 0.3],[0.3 0.6 0.3],[0.7 0.3 0.2],[0.5 0.9 0.1],'m',[0.6 0.8 0.2],[0.2 0.9 0.5]};
linewidth=2.5;
current_marker_size=20;

figure;
ax=axes;
xlabel(ax,'ACIR [dB]');

%UMa
% ylabel(ax,'系统平均吞吐量损失 [%]');
% %下行
% loss=[
%     46.388132 29.485541 16.137465 7.629327 3.154406 1.179540 0.412494 0.137458;
%     37.812121 24.121834 13.753327 6.967426 3.094923 1.221109 0.443186 0.151134;
%     28.852830 17.973052 10.161272 5.119658 2.278380 0.866624 0.298621 0.104120;
%     18.032852 10.386493 5.528109 2.748260 1.251039 0.449664 0.161073 0.041615;
%     11.148477 6.098784 3.193460 1.551531 0.663818 0.226946 0.074109 0.026373;
%     ];
% displayname={'without BF','2x2','4x4','8x8','16x8'};
% %上行
% loss=[
%     23.025605 12.006421 5.360051 2.135152 0.757077 0.258276 0.084478 0.027047;
%     26.486892 15.566419 8.103550 3.763661 1.573549 0.589228 0.203513 0.066771;
%     19.510610 11.357214 5.966365 2.811535 1.177149 0.441821 0.151895 0.049641 ;
%     10.946218 6.004293 2.983205 1.347674 0.556131 0.209598 0.072766 0.023928 
%     6.436560 3.367664 1.629652 0.737789 0.310269 0.118767 0.041422 0.013623;
%     ];
% displayname={'without BF','2x2','4x4','8x8','16x8'};

% ylabel(ax,'边缘用户吞吐量损失 [%]');
% %下行
% loss=[
%     100.000000 63.372102 2.460937 0.795326 0.253267 0.080268 0.025401 0.008034;
%     72.276654 34.647371 16.170766 2.807600 0.267988 0.086444 0.027375 0.008661;
%     47.247110 25.371946 8.716643 0.778986 0.116554 0.036940 0.011690 0.003697 ;
%     28.400401 13.253193 4.014939 1.407981 0.611740 0.129502 0.041257 0.013078 ;
%     27.532056 9.077275 1.891008 0.685777 0.240148 0.090380 0.022332 0.007073 ;
%     ];
% displayname={'without BF','2x2','4x4','8x8','16x8'};
% %上行
% loss=[
%     100 100 100 100 100 100 100 100;
%     100 100 100 100 100 100 100 100;
%     100.000000 42.758073 19.123905 6.960741 2.311644 0.742797 0.236097 0.074782 ;
%     67.266556 32.723030 17.958028 9.221530 3.725784 1.296076 0.423412 0.135316
%     39.066601 18.526587 8.609421 3.279338 1.113595 0.360758 0.114977 0.036450;
%     ];
% displayname={'without BF','2x2','4x4','8x8','16x8'};

% UMi
% ylabel(ax,'系统平均吞吐量损失 [%]');
% loss=[8.675,4.934,2.676,1.358,0.648,0.299,0.131,0.052;
%     3.651,1.879,0.907,0.409,0.168,0.062,0.021,0.007];
% displayname={'下行单用户','上行单用户'};

% ylabel(ax,'边缘用户吞吐量损失 [%]');
% loss=[23.09,9.783,2.973,0.401,0.128,0.034,0.004,0;
%     18.52,9.97,4.117,0.234,0.047,0.007,0.002,0];
% displayname={'下行单用户','上行单用户'};

% inh
% ylabel(ax,'系统平均吞吐量损失 [%]');
% loss=[17.65068834	10.21719685	5.263909336	2.36092784	0.881144822	0.286853889	0.097373085	0.030865462;
%     6.760455114	3.092771435	1.255148595	0.465305554	0.162625874	0.054373106	0.017622695	0.005623214
% ];
% displayname={'下行单用户','上行单用户'};

ylabel(ax,'边缘用户吞吐量损失 [%]');
loss=[26.66028057	7.827198941	3.324616786	0.340283703	0.038676072	0.012241259	0.003871934	0.001224365;
    21.26257802	3.900138567	1.180162246	0.24168415	0.027164302	0.008593981	0.002717988	0.000859701];
displayname={'下行单用户','上行单用户'};

hold all;
grid on;
for i=1:size(loss,1)
    current_marker=markers{i};
    current_marker_color=marker_color{i};
    if i==1
        current_marker_size=20;
    else
        current_marker_size=8;
    end
    length(displayname)
    plot(ax,[5:5:40],loss(i,:),'DisplayName',displayname{i},'Marker',current_marker,'MarkerSize',current_marker_size,'LineWidth',linewidth,'Color',current_marker_color);
end
plot(ax,[5:5:40],5*ones(size(5:5:40)),'--m','DisplayName','基准','MarkerSize',current_marker_size,'LineWidth',linewidth);
xlim(ax,[5,40]);
legend(ax,'show','Location','Best');
